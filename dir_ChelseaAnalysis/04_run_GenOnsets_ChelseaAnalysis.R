Spline1 <- c(1.987074, 2.047370,2.110105,2.175266,2.242839,2.312808,2.385156,2.459863,2.536908,2.616268,
2.697919,2.781834,2.867986,2.956345,3.046880,3.139559,3.234348,3.331210,3.430109,3.531008,
3.633865,3.738640,3.845290,3.953773,4.064043,4.176055,4.289762,4.405115,4.522067,4.640567,
4.760564,4.882008,5.004845,5.129024,5.254490,5.381189,5.509067,5.638068,5.768137,5.899218,
6.031255,6.164191,6.297969,6.432534,6.567827,6.703793,6.840374,6.977514,7.115156,7.253244,
7.391722,7.530534,7.669625,7.808941,7.948426,8.088028,8.227692,8.367367,8.507001,8.646541,
8.785939,8.925145,9.064110,9.202787,9.341128,9.479088,9.616623,9.753689,9.890243,10.026244,
10.161653,10.296429,10.430536,10.563937,10.696597,10.828482,10.959559,11.089797,11.219167,11.347640,
11.475189,11.601789,11.727414,11.852043,11.975653,12.098225,12.219741,12.340182,12.459533,12.577781,
12.694911,12.810913,12.925776,13.039492,13.152052,13.263452,13.373685,13.482750,13.590642,13.697362,
13.802910,13.907287,14.010497,14.112542,14.213428,14.313161,14.411747,14.509196,14.605516,14.700718,
14.794811,14.887809,14.979724,15.070569,15.160359,15.249108,15.336833,15.423549,15.509274,15.594025,
15.677819,15.760676,15.842613,15.923651,16.003808,16.083104,16.161560,16.239195,16.316031,16.392086,
16.467382,16.541939,16.615778,16.688919,16.761382,16.833188,16.904356,16.974907,17.044859,17.114231,
17.183043,17.251313,17.319059,17.386298,17.453048,17.519324,17.585144,17.650521,17.715473,17.780011,
17.844151,17.907904,17.971283,18.034301,18.096966,18.159290,18.221282,18.282950,18.344302,18.405345,
18.466084,18.526527,18.586676,18.646535,18.706108,18.765397,18.824402,18.883125,18.941564,18.999720,
19.057589,19.115169,19.172457,19.229449,19.286138,19.342521,19.398590,19.454339,19.509759,19.564842,
19.619580,19.673963,19.727980,19.781621,19.834876,19.887731,19.940175,19.992196,20.043781,20.094917,
20.145589,20.195784,20.245489,20.294688,20.343368,20.391514,20.439111,20.486144,20.532599,20.578461,
20.623715,20.668348,20.712343,20.755688,20.798368,20.840370,20.881680,20.922285,20.962172,21.001329,
21.039744,21.077406,21.114304,21.150427,21.185766,21.220312,21.254056,21.286991,21.319109,21.350405,
21.380873,21.410508,21.439306,21.467264,21.494381,21.520655,21.546086,21.570674,21.594421,21.617330,
21.639404,21.660648,21.681067,21.700669,21.719460,21.737450,21.754648,21.771065,21.786713,21.801604,
21.815754,21.829176,21.841886,21.853903,21.865243,21.875926,21.885971,21.895401,21.904237,21.912501,
21.920218,21.927413,21.934111,21.940338,21.946122,21.951491,21.956473,21.961099,21.965399,21.969403,
21.973144,21.976653,21.979963,21.983107,21.986120,21.989035,21.991887,21.994711,21.997542,22.000415,
22.003367,22.006433,22.009649,22.013051,22.016676,22.020559,22.024736,22.029243,22.034116,22.039390,
22.045101,22.051283,22.057971,22.065199,22.073000,22.081408,22.090454,22.100172,22.110592,22.121744,
22.133658,22.146363,22.159888,22.174259,22.189503,22.205644,22.222708,22.240717,22.259693,22.279658,
22.300631,22.322630,22.345674,22.369777,22.394955,22.421222,22.448589,22.477067,22.506666,22.537392,
22.569254,22.602256,22.636401,22.671692,22.708129,22.745711,22.784436,22.824301,22.865299,22.907423,
22.950666,22.995018,23.040467,23.087000,23.134603,23.183259,23.232953,23.283665,23.335375,23.388061,
23.441702,23.496272,23.551746,23.608098,23.665299,23.723320,23.782131,23.841701,23.901996,23.962984,
24.024629,24.086896,24.149748,24.213148,24.277057,24.341437,24.406248,24.471449,24.537000,24.602858,
24.668982,24.735329,24.801856,24.868520,24.935277,25.002085,25.068897,25.135672,25.202365,25.268931,
25.335328,25.401511,25.467437,25.533063,25.598346,25.663244,25.727715,25.791718,25.855211,25.918155,
25.980511,26.042240,26.103305,26.163668,26.223293,26.282147,26.340195,26.397404,26.453744,26.509184,
26.563695,26.617249,26.669820,26.721384,26.771917,26.821397,26.869803,26.917118,26.963323,27.008404,
27.052346,27.095137,27.136767,27.177226,27.216508,27.254608,27.291523,27.327249,27.361789,27.395144,
27.427317,27.458314,27.488144,27.516815,27.544338,27.570726,27.595995,27.620161,27.643242,27.665258,
27.686232,27.706186,27.725147,27.743140,27.760196,27.776344,27.791615,27.806044,27.819664,27.832513,
27.844627,27.856046,27.866810,27.876961,27.886542,27.895596,27.904168,27.912305,27.920053,27.927460,
27.934576,27.941449,27.948130,27.954670,27.961120,27.967533,27.973960,27.980455,27.987070,27.993859,
28.000876,28.008173,28.015804,28.023822,28.032282,28.041235,28.050734,28.060832,28.071580,28.083030,
28.095232,28.108236,28.122092,28.136847,28.152548,28.169244,28.186977,28.205794,28.225736,28.246845,
28.269162,28.292726,28.317574,28.343743,28.371266,28.400176,28.430504,28.462281,28.495532,28.530284,
28.566560,28.604382,28.643771,28.684743,28.727314,28.771498,28.817307,28.864750,28.913833,28.964562,
29.016939,29.070965,29.126638,29.183953,29.242905,29.303484,29.365680,29.429480,29.494866,29.561823,
29.630329,29.700362,29.771898,29.844910,29.919368,29.995241,30.072496,30.151098,30.231008,30.312187,
30.394593,30.478183,30.562912,30.648731,30.735591,30.823442,30.912230,31.001902,31.092401,31.183670,
31.275650,31.368281,31.461501,31.555247,31.649455,31.744060,31.838995,31.934195,32.029590,32.125113,
32.220694,32.316262,32.411747,32.507080,32.602187,32.696998,32.791442,32.885446,32.978939,33.071850,
33.164107,33.255639,33.346376,33.436248,33.525186,33.613120,33.699983,33.785707,33.870227,33.953478,
34.035395,34.115916,34.194979,34.272526,34.348496,34.422834,34.495483,34.566392,34.635507,34.702779,
34.768161,34.831606,34.893070,34.952513,35.009894,35.065178,35.118328,35.169314,35.218104,35.264673,
35.308994,35.351046,35.390810,35.428269,35.463408,35.496217,35.526687,35.554811,35.580588,35.604017,
35.625101,35.643846,35.660261,35.674356,35.686146,35.695649,35.702884,35.707875,35.710647,35.711230,
35.709654,35.705955,35.700169,35.692335,35.682498,35.670701,35.656993,35.641424,35.624047,35.604918,
35.584094,35.561636,35.537606,35.512069,35.485093,35.456746,35.427099,35.396226,35.364201,35.331102,
35.297007,35.261996,35.226151,35.189556,35.152295,35.114453,35.076118,35.037379,34.998324,34.959044,
34.919629,34.880171,34.840763,34.801497,34.762466,34.723763,34.685483,34.647719,34.610564,34.574112,
34.538457,34.503690,34.469906,34.437194,34.405648,34.375357,34.346411,34.318899,34.292907,34.268523,
34.245832,34.224917,34.205860,34.188743,34.173645,34.160642,34.149810,34.141224,34.134953,34.131069,
34.129638,34.130724,34.134392,34.140702,34.149710,34.161474,34.176044,34.193473,34.213806,34.237089,
34.263364,34.292670,34.325042,34.360514,34.399116,34.440876,34.485817,34.533961,34.585325,34.639925)

Spline2 <- c(10.38646,10.43971,10.49129,10.54121,10.58948,10.63609,10.68107,10.72441,10.76614,10.80626,10.84479,
10.88173, 10.91712, 10.95095, 10.98326, 11.01405, 11.04335, 11.07118, 11.09755, 11.12249, 11.14603, 11.16817,
11.18896, 11.20841, 11.22654, 11.24339, 11.25899, 11.27335, 11.28652, 11.29851, 11.30936, 11.31909, 11.32774,
11.33535, 11.34193, 11.34753, 11.35217, 11.35589, 11.35872, 11.36070, 11.36186, 11.36224, 11.36186, 11.36077,
11.35900, 11.35658, 11.35356, 11.34995, 11.34581, 11.34117, 11.33605, 11.33050, 11.32456, 11.31825, 11.31162,
11.30469, 11.29751, 11.29011, 11.28251, 11.27477, 11.26690, 11.25895, 11.25095, 11.24293, 11.23492, 11.22695,
11.21906, 11.21128, 11.20364, 11.19617, 11.18890, 11.18186, 11.17507, 11.16856, 11.16237, 11.15652, 11.15104,
11.14594, 11.14127, 11.13703, 11.13325, 11.12997, 11.12719, 11.12494, 11.12324, 11.12212, 11.12158, 11.12166,
11.12236, 11.12370, 11.12571, 11.12839, 11.13176, 11.13583, 11.14062, 11.14614, 11.15240, 11.15941, 11.16719,
11.17573, 11.18506, 11.19518, 11.20609, 11.21780, 11.23031, 11.24364, 11.25779, 11.27276, 11.28855, 11.30516,
11.32260, 11.34087, 11.35996, 11.37988, 11.40063, 11.42220, 11.44460, 11.46781, 11.49185, 11.51669, 11.54234,
11.56880, 11.59606, 11.62411, 11.65294, 11.68256, 11.71295, 11.74410, 11.77602, 11.80868, 11.84209, 11.87623,
11.91109, 11.94667, 11.98296, 12.01994, 12.05761, 12.09596, 12.13497, 12.17464, 12.21496, 12.25590, 12.29748,
12.33967, 12.38246, 12.42584, 12.46980, 12.51434, 12.55943, 12.60507, 12.65126, 12.69796, 12.74519, 12.79292,
12.84115, 12.88986, 12.93905, 12.98870, 13.03881, 13.08936, 13.14035, 13.19177, 13.24361, 13.29585, 13.34849,
13.40153, 13.45494, 13.50873, 13.56289, 13.61741, 13.67228, 13.72750, 13.78305, 13.83893, 13.89514, 13.95167,
14.00851, 14.06566, 14.12311, 14.18086, 14.23890, 14.29723, 14.35584, 14.41473, 14.47389, 14.53333, 14.59303,
14.65300, 14.71323, 14.77372, 14.83447, 14.89548, 14.95673, 15.01824, 15.07999, 15.14200, 15.20424, 15.26674,
15.32947, 15.39245, 15.45567, 15.51913, 15.58283, 15.64677, 15.71095, 15.77536, 15.84002, 15.90491, 15.97003,
16.03540, 16.10100, 16.16684, 16.23291, 16.29922, 16.36576, 16.43253, 16.49954, 16.56678, 16.63426, 16.70197,
16.76990, 16.83807, 16.90646, 16.97508, 17.04393, 17.11300, 17.18229, 17.25181, 17.32154, 17.39148, 17.46164,
17.53201, 17.60259, 17.67338, 17.74436, 17.81554, 17.88692, 17.95848, 18.03023, 18.10217, 18.17427, 18.24656,
18.31900, 18.39161, 18.46437, 18.53728, 18.61034, 18.68353, 18.75685, 18.83029, 18.90385, 18.97752, 19.05128,
19.12514, 19.19909, 19.27311, 19.34720, 19.42135, 19.49555, 19.56979, 19.64406, 19.71835, 19.79266, 19.86697,
19.94127, 20.01555, 20.08981, 20.16403, 20.23821, 20.31232, 20.38636, 20.46033, 20.53421, 20.60798, 20.68164,
20.75518, 20.82858, 20.90185, 20.97495, 21.04789, 21.12065, 21.19323, 21.26561, 21.33777, 21.40972, 21.48145,
21.55293, 21.62416, 21.69513, 21.76583, 21.83626, 21.90640, 21.97624, 22.04577, 22.11499, 22.18389, 22.25245,
22.32068, 22.38856, 22.45609, 22.52325, 22.59005, 22.65648, 22.72252, 22.78818, 22.85344, 22.91831, 22.98278,
23.04685, 23.11050, 23.17375, 23.23658, 23.29898, 23.36097, 23.42254, 23.48368, 23.54440, 23.60469, 23.66455,
23.72399, 23.78300, 23.84159, 23.89975, 23.95749, 24.01481, 24.07172, 24.12821, 24.18429, 24.23997, 24.29524,
24.35011, 24.40459, 24.45868, 24.51239, 24.56572, 24.61868, 24.67128, 24.72352, 24.77541, 24.82696, 24.87818,
24.92906, 24.97963, 25.02990, 25.07986, 25.12953, 25.17891, 25.22803, 25.27688, 25.32548, 25.37383, 25.42195,
25.46985, 25.51753, 25.56501, 25.61230, 25.65941, 25.70634, 25.75311, 25.79973, 25.84621, 25.89256, 25.93879,
25.98490, 26.03092, 26.07685, 26.12269, 26.16846, 26.21418, 26.25983, 26.30545, 26.35103, 26.39658, 26.44211,
26.48764, 26.53316, 26.57868, 26.62422, 26.66977, 26.71535, 26.76096, 26.80660, 26.85229, 26.89802, 26.94380,
26.98963, 27.03552, 27.08147, 27.12748, 27.17356, 27.21971, 27.26592, 27.31220, 27.35854, 27.40496, 27.45144,
27.49799, 27.54460, 27.59127, 27.63800, 27.68478, 27.73161, 27.77849, 27.82541, 27.87237, 27.91935, 27.96636,
28.01338, 28.06041, 28.10744, 28.15447, 28.20147, 28.24845, 28.29540, 28.34229, 28.38913, 28.43591, 28.48260,
28.52920, 28.57569, 28.62207, 28.66832, 28.71443, 28.76038, 28.80616, 28.85176, 28.89716, 28.94235, 28.98731,
29.03202, 29.07648, 29.12067, 29.16456, 29.20816, 29.25143, 29.29437, 29.33696, 29.37919, 29.42103, 29.46247,
29.50351, 29.54411, 29.58427, 29.62397, 29.66320, 29.70195, 29.74019, 29.77791, 29.81510, 29.85175, 29.88784,
29.92336, 29.95829, 29.99263, 30.02636, 30.05948, 30.09196, 30.12380, 30.15499, 30.18552, 30.21538, 30.24456,
30.27306, 30.30087, 30.32797, 30.35437, 30.38006, 30.40503, 30.42929, 30.45282, 30.47563, 30.49771, 30.51906,
30.53968, 30.55958, 30.57875, 30.59719, 30.61492, 30.63192, 30.64821, 30.66379, 30.67867, 30.69285, 30.70635,
30.71916, 30.73130, 30.74278, 30.75362, 30.76381, 30.77338, 30.78233, 30.79069, 30.79846, 30.80566, 30.81231,
30.81843, 30.82403, 30.82913, 30.83375, 30.83791, 30.84163, 30.84494, 30.84785, 30.85038, 30.85257, 30.85443,
30.85599, 30.85727, 30.85830, 30.85911, 30.85971, 30.86015, 30.86043, 30.86060, 30.86069, 30.86071, 30.86069,
30.86068, 30.86068, 30.86075, 30.86090, 30.86116, 30.86156, 30.86214, 30.86293, 30.86394, 30.86523, 30.86680,
30.86870, 30.87095, 30.87359, 30.87664, 30.88013, 30.88410, 30.88856, 30.89355, 30.89910, 30.90524, 30.91198,
30.91937, 30.92742, 30.93616, 30.94562, 30.95583, 30.96680, 30.97856, 30.99113, 31.00454, 31.01881, 31.03395,
31.05000, 31.06696, 31.08487, 31.10372, 31.12355, 31.14437, 31.16620, 31.18904, 31.21291, 31.23783, 31.26381,
31.29085, 31.31897, 31.34817, 31.37847, 31.40987, 31.44237, 31.47598, 31.51070, 31.54655, 31.58350, 31.62158,
31.66077, 31.70108, 31.74250, 31.78503, 31.82866, 31.87339, 31.91921, 31.96612, 32.01409, 32.06313, 32.11322,
32.16435, 32.21651, 32.26967, 32.32384, 32.37898, 32.43509, 32.49215, 32.55013, 32.60902, 32.66879, 32.72943,
32.79091, 32.85321, 32.91631, 32.98018, 33.04480, 33.11013, 33.17616, 33.24286, 33.31019, 33.37814, 33.44666,
33.51574, 33.58534, 33.65543, 33.72599, 33.79697, 33.86836, 33.94011, 34.01220, 34.08459, 34.15725, 34.23015,
34.30326, 34.37654, 34.44997, 34.52350, 34.59711, 34.67077, 34.74444, 34.81808, 34.89168, 34.96519, 35.03859,
35.11184, 35.18491, 35.25778, 35.33041, 35.40278, 35.47485, 35.54659, 35.61799, 35.68900, 35.75961, 35.82978,
35.89950, 35.96874, 36.03747, 36.10568, 36.17333, 36.24041, 36.30689, 36.37276, 36.43800, 36.50259, 36.56651,
36.62974, 36.69228, 36.75410, 36.81520, 36.87555, 36.93516, 36.99400, 37.05208, 37.10938, 37.16589, 37.22162)

CPA1 <- c(0.000057100,0.000264286,0.001692857,0.009092857,0.007178571,0.001764286,0.007278571,0.008714286,
0.005357143,0.010000000,0.007992857,0.010835714,0.010600000,0.014185714,0.016892857,0.018057143,
0.018192857,0.018257143,0.018528571,0.161228571,0.090007143,0.183714286,0.174707143,0.125671429,
0.001178571,0.001785714,0.021007143,0.003907143,0.005150000,0.081657143,0.148885714,0.151192857,
0.081342857,0.226785714,0.211685714,0.025900000,0.007371429,0.140950000,0.077357143,0.006442857,
0.146414286,0.286864286,0.080278571,0.088585714,0.033207143,0.097185714,0.055521429,0.121950000,
0.085835714,0.012900000,0.010264286,0.007171429,0.005685714,0.006771429,0.077235714,0.151942857,
0.064542857,0.012500000,0.017521429,0.020000000,0.019207143,0.021650000,0.025171429,0.027628571,
0.097750000,0.036128571,0.038600000,0.049978571,0.124685714,0.053242857,0.053178571,0.022557143,
0.096057143,0.118728571,0.032900000,0.035321429,0.037107143,0.045092857,0.063014286,0.069835714,
0.139464286,0.164728571,0.098971429,0.181135714,0.172535714,0.112492857,0.138657143,0.036964286,
0.035821429,0.000464286,0.000728571,0.001178571,0.008200000,0.025028571,0.000464286,0.000200000,
0.000107143,0.000192857,0.000335714,0.000371429,0.000757143,0.001435714,0.001992857,0.003614286,
0.006435714,0.008964286,0.006614286,0.003150000,0.001942857,0.002935714,0.006314286,0.012421429,
0.012550000,0.007692857,0.016807143,0.019757143,0.022900000,0.032450000,0.035871429,0.036407143,
0.039314286,0.004471429,0.033000000,0.001728571,0.002171429,0.002578571,0.002778571,0.003764286,
0.004185714,0.005292857,0.006364286,0.006750000,0.077814286,0.097257143,0.076807143,0.079014286,
0.090957143,0.083757143,0.097971429,0.084928571,0.213892857,0.104985714,0.015064286,0.023885714,
0.019657143,0.022292857,0.035035714,0.041600000,0.042250000,0.063664286,0.128628571,0.065707143,
0.154478571,0.204907143,0.155550000,0.150085714,0.045900000,0.047157143,0.104935714,0.101792857,
0.017242857,0.011764286,0.032278571,0.081150000,0.029292857,0.017628571,0.015035714,0.020221429,
0.025135714,0.028085714,0.107757143,0.092971429,0.050185714,0.057078571,0.080071429,0.082042857,
0.097764286,0.087642857,0.056942857,0.038200000,0.023585714,0.024442857,0.034321429,0.055414286,
0.209407143,0.208371429,0.213971429,0.205585714,0.232978571,0.141242857,0.118414286,0.138900000,
0.110050000,0.048150000,0.053971429,0.000992857,0.000735714,0.000678571,0.001142857,0.001271429,
0.003014286,0.037842857,0.071328571,0.000914286,0.000764286,0.000821429,0.000921429,0.001364286,
0.001664286,0.001800000,0.002078571,0.002507143,0.002814286,0.002885714,0.002614286,0.002342857,
0.002592857,0.003171429,0.003700000,0.003971429,0.005042857,0.005300000,0.004964286,0.005435714,
0.006242857,0.008250000,0.018914286,0.052642857,0.030464286,0.080778571,0.081935714,0.012371429,
0.013871429,0.013321429,0.084214286,0.155300000,0.015192857,0.071942857,0.147742857,0.095064286,
0.016628571,0.162957143,0.165757143,0.031214286,0.035207143,0.177685714,0.252092857,0.165950000,
0.099471429,0.018964286,0.025128571,0.094228571,0.133014286,0.132185714,0.011192857,0.003785714,
0.002328571,0.002442857,0.002685714,0.002835714,0.002892857,0.002892857,0.002321429,0.002114286,
0.002735714,0.003078571,0.003207143,0.004442857,0.007885714,0.012807143,0.014392857,0.008021429,
0.004678571,0.007142857,0.018428571,0.017042857,0.016292857,0.026671429,0.036550000,0.038307143,
0.038378571,0.041692857,0.110557143,0.133607143,0.075907143,0.005157143,0.005021429,0.005171429,
0.005664286,0.006107143,0.005821429,0.005900000,0.077971429,0.078700000,0.007378571,0.007050000,
0.007985714,0.008800000,0.008464286,0.009364286,0.009828571,0.010271429,0.010942857,0.011507143,
0.012200000,0.013164286,0.014035714,0.014714286,0.016078571,0.016557143,0.017714286,0.019435714,
0.022485714,0.028407143,0.035914286,0.039450000,0.032585714,0.033078571,0.044900000,0.047671429,
0.055985714,0.063442857,0.069971429,0.063678571,0.031171429,0.031014286,0.042507143,0.034100000,
0.080214286,0.145835714,0.075500000,0.147778571,0.075835714,0.077714286,0.006835714,0.086342857,
0.135750000,0.214421429,0.094935714,0.010050000,0.145100000,0.075957143,0.007135714,0.008900000,
0.009785714,0.009414286,0.084557143,0.100378571,0.190128571,0.165385714,0.089150000,0.154978571,
0.082657143,0.022992857,0.035207143,0.103614286,0.134535714,0.130814286,0.102171429,0.174900000,
0.114114286,0.129935714,0.021400000,0.007357143,0.006350000,0.007278571,0.008321429,0.009050000,
0.009085714,0.010035714,0.010821429,0.012178571,0.012685714,0.014235714,0.016085714,0.018414286,
0.162178571,0.094314286,0.096771429,0.029235714,0.033835714,0.037742857,0.043142857,0.042857143,
0.047885714,0.124300000,0.137221429,0.265650000,0.214142857,0.072950000,0.002842857,0.027550000,
0.004442857,0.000292857,0.000050000,0.000028600,0.000021400,0.000471429,0.000064300,0.000285714,
0.000085700,0.071442857,0.071528571,0.000042900,0.000042900,0.000121429,0.000164286,0.000357143,
0.065528571,0.071592857,0.000092900,0.000078600,0.000057100,0.000078600,0.000250000,0.000114286,
0.000221429,0.000321429,0.000278571,0.000407143,0.000650000,0.000650000,0.000928571,0.001057143,
0.001114286,0.001107143,0.000950000,0.000928571,0.000978571,0.001178571,0.001471429,0.001978571,
0.002878571,0.004950000,0.006814286,0.008178571,0.008178571,0.007128571,0.004828571,0.003642857,
0.003414286,0.004335714,0.077521429,0.082114286,0.014257143,0.013100000,0.013035714,0.018500000,
0.024557143,0.035178571,0.182821429,0.132900000,0.053664286,0.065564286,0.072450000,0.065585714,
0.025642857,0.016885714,0.000678571,0.000550000,0.000835714,0.001814286,0.024628571,0.072300000,
0.001042857,0.001271429,0.072978571,0.069442857,0.072778571,0.144128571,0.072800000,0.001557143,
0.001478571,0.001628571,0.073121429,0.072792857,0.002078571,0.002478571,0.002928571,0.074664286,
0.075335714,0.075492857,0.006557143,0.007678571,0.009121429,0.010000000,0.008957143,0.006921429,
0.004971429,0.005100000,0.006021429,0.008414286,0.012100000,0.019000000,0.026200000,0.023321429,
0.095528571,0.111171429,0.040814286,0.116950000,0.142314286,0.113207143,0.142371429,0.172378571,
0.339792857,0.107835714,0.077650000,0.150050000,0.006871429,0.001542857,0.071642857,0.070242857,
0.071650000,0.000492857,0.072264286,0.073335714,0.076535714,0.087628571,0.045257143,0.006807143,
0.077021429,0.092592857,0.017150000,0.106957143,0.108371429,0.073728571,0.171821429,0.073528571,
0.001692857,0.001492857,0.003178571,0.012500000,0.060635714,0.146707143,0.003771429,0.004178571,
0.004657143,0.005771429,0.005914286,0.005807143,0.005414286,0.005650000,0.005557143,0.007457143,
0.009285714,0.082250000,0.018214286,0.101385714,0.167100000,0.263978571,0.196257143,0.059514286,
0.021835714,0.027264286,0.032814286,0.040650000,0.044328571,0.061792857,0.019292857,0.051557143,
0.065371429,0.008735714,0.000342857,0.000742857,0.010264286,0.010600000,0.006421429,0.012421429,
0.019078571,0.053164286,0.159742857,0.142971429,0.139342857,0.070542857,0.000278571,0.000385714,
0.000550000,0.000957143,0.003457143,0.011164286,0.011292857,0.017785714,0.031550000,0.071614286,
0.067857143,0.071842857,0.000542857,0.001135714,0.075450000,0.032214286,0.104992857,0.071828571,
0.000335714,0.000557143,0.000414286,0.000621429,0.000707143,0.000857143,0.000864286,0.001007143,
0.000935714,0.000964286,0.001114286,0.001257143,0.001242857,0.001364286,0.001471429,0.001564286,
0.001571429,0.001821429,0.002657143,0.069950000,0.075735714,0.007478571,0.085064286,0.117885714,
0.115671429,0.076178571,0.010678571,0.006792857,0.018085714,0.020685714,0.025414286,0.067757143,
0.117300000,0.045414286,0.058478571,0.034950000,0.040014286,0.078564286,0.010014286,0.012607143,
0.087321429,0.089700000,0.020607143,0.054407143,0.117007143,0.151957143,0.004271429,0.008221429,
0.000092900,0.000028600,0.000135714,0.000207143,0.000692857,0.004571429,0.025771429,0.070385714,
0.000092900,0.000035700,0.000028600,0.000014300,0.000014300,0.000085700,0.000000000,0.000000000,
0.000042900,0.000014300,0.000000000,0.000000000)

CPA2 <- c(0.0084375,0.1168250,0.0911500,0.0341750,0.0000375,0.0001625,0.0003000,0.0007750,0.0012875,0.0039625,
0.0092250,0.0157875,0.0161125,0.0114375,0.0047250,0.0042625,0.0109125,0.0173000,0.0191375,0.0176250,
0.0191375,0.0253375,0.0326125,0.0308750,0.0433000,0.0546750,0.0634250,0.0638250,0.0653375,0.0688500,
0.1272125,0.0025750,0.0651125,0.0038125,0.0045125,0.0058000,0.0052125,0.0055375,0.0058625,0.0060625,
0.0074125,0.0097375,0.0113500,0.1290500,0.0079750,0.0082000,0.0126500,0.0113500,0.0131875,0.0176375,
0.0260000,0.1262750,0.1316000,0.0961125,0.0243000,0.1514125,0.0286375,0.0386875,0.0707375,0.0723750,
0.0921375,0.0942000,0.0979500,0.1528375,0.0500750,0.0403125,0.0028875,0.0105500,0.0001500,0.0002125,
0.0001750,0.0002375,0.0003625,0.0004875,0.0003875,0.0002125,0.0001375,0.0002500,0.0002000,0.0001500,
0.0002750,0.0003875,0.0026750,0.1248250,0.0015625,0.0010250,0.0013500,0.0017875,0.0029375,0.0050125,
0.0047125,0.0018875,0.0020125,0.0041250,0.0093875,0.0089125,0.0150000,0.0184500,0.1067125,0.0163500,
0.0022125,0.0000625,0.0001125,0.0001125,0.0000625,0.0004125,0.0000750,0.0002125,0.0001500,0.0001375,
0.0001875,0.0001125,0.1251625,0.1249250,0.0001875,0.0003750,0.0004375,0.0001750,0.0001500,0.0001875,
0.0001500,0.0002000,0.0001750,0.0002125,0.0002750,0.0005125,0.0004625,0.0008375,0.0021250,0.0130125,
0.0625750,0.2509625,0.2475500,0.0598125,0.0004000,0.2501625,0.0187000,0.1254125,0.0999375,0.0004625,
0.0003875,0.0002375,0.0003875,0.0002875,0.0004875,0.0004500,0.0003250,0.0004625,0.0004375,0.0004625,
0.0005250,0.0005000,0.0005375,0.0006875,0.0008500,0.0007125,0.0008000,0.0009875,0.0009375,0.0009250,
0.0012250,0.0011375,0.0010625,0.0013250,0.0012000,0.0015125,0.0013000,0.0015750,0.0017250,0.0019750,
0.0020375,0.0020250,0.0021375,0.0021875,0.0024625,0.0027750,0.0024625,0.0027250,0.0033750,0.0037125,
0.0043000,0.0044000,0.0047625,0.0050500,0.0071500,0.0109625,0.1194250,0.0123000,0.0045875,0.0059000,
0.0077625,0.1920000,0.1312250,0.0061250,0.0066250,0.0070625,0.0084625,0.0091125,0.0095750,0.0102500,
0.0108375,0.0117875,0.0128250,0.0128875,0.0154250,0.0214375,0.0266875,0.0250250,0.0301375,0.0427625,
0.0521750,0.0730750,0.0759000,0.1915125,0.1925000,0.0925875,0.0560000,0.0707500,0.0175500,0.0912500,
0.1263500,0.0454625,0.0007625,0.0013875,0.0044625,0.0037875,0.0077625,0.0162500,0.0308500,0.0754625,
0.1475750,0.0598750,0.1946750,0.2192500,0.1314250,0.2226500,0.1338375,0.0152000,0.1447125,0.1449250,
0.0230750,0.1022125,0.0392750,0.0191625,0.0006875,0.0019875,0.0018000,0.0012500,0.0029875,0.0032875,
0.0041625,0.0044875,0.0049125,0.1207500,0.0044125,0.0000875,0.0001875,0.0002250,0.0001375,0.1250500,
0.1175000,0.0005125,0.0003750,0.0001125,0.0003375,0.0005125,0.0004875,0.0009000,0.1267375,0.1265250,
0.0017000,0.0027125,0.0035375,0.0041250,0.1261125,0.0047750,0.0029375,0.0033000,0.0031750,0.0091000,
0.1194875,0.1456375,0.0962625,0.1009125,0.0042000,0.0053750,0.0058500,0.0058875,0.0056375,0.0043000,
0.0340375,0.1273750,0.0030625,0.0205625,0.0897875,0.2359375,0.1426000,0.0336375,0.0951875,0.1371375,
0.0210875,0.0217500,0.1104875,0.1565750,0.0430750,0.0443125,0.2096375,0.0486875,0.0429250,0.0072375,
0.0078875,0.0378875,0.2298250,0.1410125,0.0180250,0.1326875,0.0241875,0.0398250,0.0298500,0.1871000,
0.0688250,0.0694875,0.1874875,0.0053375,0.0039500,0.0036875,0.0033875,0.0033000,0.0042250,0.0044375,
0.0064000,0.1315625,0.1312375,0.0076625,0.0473000,0.1362875,0.0144125,0.0456125,0.1369500,0.0168750,
0.0219625,0.0232000,0.0200000,0.0316000,0.0478750,0.0547125,0.0715750,0.2430375,0.2066125,0.0519500,
0.2071250,0.2736000,0.1393875,0.2763375,0.1658125,0.0532125,0.0630875,0.0817125,0.0881750,0.0925750,
0.2177125,0.3326000,0.0404875,0.1578125,0.1603125,0.1797375,0.3593250,0.3483000,0.2832250,0.0009125,
0.1253250,0.1251000,0.1254250,0.0036750,0.1283375,0.1282000,0.1252000,0.0203250,0.2501250,0.0008500,
0.0019125,0.1063375,0.1254500,0.0007750,0.1257500,0.0010250,0.0015500,0.1239750,0.0324625,0.0004375,
0.1253000,0.0005500,0.0012000,0.0011250,0.1260500,0.2521875,0.2505125,0.1582125,0.2125250,0.1599250,
0.1594625,0.0915750,0.1216875,0.1264625,0.2517875,0.2917750,0.1276375,0.1274250,0.1064500,0.0042250,
0.0054000,0.0091000,0.0190625,0.0213500,0.0337625,0.0824625,0.0321125,0.0027000,0.0065375,0.0022000,
0.0011250,0.0016625,0.0027625,0.0038125,0.0063625,0.0099750,0.0118625,0.0107500,0.0064375,0.0021250,
0.0008000,0.0013625,0.0026000,0.0051750,0.0099375,0.0151375,0.0149875,0.0083125,0.0045625,0.0100625,
0.0182875,0.0195125,0.0124625,0.0203375,0.0262500,0.0239250,0.0330375,0.0322250,0.0505000,0.0574750,
0.0579500,0.0580125,0.0581875,0.0666750,0.0673125,0.0005625,0.0579625,0.1253375,0.2499250,0.1254500,
0.0002750,0.0001500,0.0002375,0.0002875,0.0005000,0.0003250,0.0003625,0.0004750,0.0006750,0.0007375,
0.0011250,0.0118500,0.0846250,0.1254625,0.1253500,0.0003250,0.0003875,0.0005375,0.0005500,0.0004625,
0.0006875,0.0003875,0.0006750,0.0007875,0.0008500,0.0008875,0.0010750,0.0903375,0.0900875,0.0009375,
0.0013500,0.0010750,0.0011875,0.0012875,0.0013000,0.0012500,0.0016875,0.0017500,0.0019625,0.0022125,
0.0023250,0.0028875,0.0028875,0.0032500,0.0036875,0.0046500,0.0077000,0.0269750,0.0385250,0.0712250,
0.1328750,0.0091500,0.0089625,0.0096375,0.0095125,0.0101125,0.0108625,0.0125625,0.0180250,0.0224625,
0.0313500,0.0507375,0.0835125,0.0316875,0.0153125,0.0224375,0.0133125,0.0119250,0.0188000,0.0165750,
0.0216375,0.0290750,0.0312875,0.0349000,0.0655750,0.0958000,0.0345250,0.0040625,0.0053625,0.0062125,
0.0080500,0.0097000,0.0109625,0.0103625,0.0094375,0.0082250,0.0056375,0.0057000,0.0074250,0.0101750,
0.0215625,0.1365250,0.0697375,0.1347500,0.0140125,0.0218000,0.0229250,0.0233375,0.0316625,0.0328375,
0.0325625,0.0337500,0.0523875,0.0579125,0.1720750,0.0746875,0.1826375,0.2342000,0.0427250,0.0694750,
0.0348875,0.0404250,0.0397625,0.0605625,0.0740500,0.0934125,0.1198375,0.1233125,0.1336125,0.1318375,
0.2443000,0.1123625,0.1615125,0.0621750,0.0277625,0.0870875,0.0280250,0.0620625,0.0855125,0.0250750,
0.0018125,0.0127125,0.0026000,0.0062125,0.0027375,0.0028875,0.0033250,0.0039250,0.0041375,0.0038000,
0.0036125,0.0036750,0.0032625,0.0029625,0.0034500,0.0043500,0.0061625,0.0107500,0.0135000,0.0132875,
0.0110375,0.0127375,0.0250375,0.0302625,0.0337250,0.0443250,0.0432375,0.0970000,0.0395750,0.0137125,
0.0123625,0.0140125,0.0129000,0.0170750,0.0229000,0.0266625,0.0280875,0.0322250,0.0319000,0.1705000,
0.1766500,0.0957625,0.0726750,0.0743750,0.0805875,0.0430750,0.0617500,0.0310875,0.1507000,0.2993875,
0.1441000,0.2871375,0.0377625,0.0378250,0.0377250,0.0404500,0.0859500,0.0876250,0.0405125,0.0412750,
0.0715375,0.0662125,0.0003000,0.0002125,0.0005625,0.0006375,0.1244125,0.2500250,0.0052250,0.0000000)

Onsets <- function(PIDs,  # An array of participant IDs to Process
                   data,
                   TASK,
                   RawDir = "/data/Uncertainty/data/raw/", # The directory in which your DICOM files are stored
                   BehavDir = "/data/Uncertainty/data/behav/", # The directory in which your MRI behavioral data is stored
                   DerivDir = "/data/Uncertainty/data/deriv/pipeline_1/fmriprep/", # The directory in which your preprocessed data is stored
                   TR = 2, # The length of your repetition time in seconds
                   ShaveLength = 17, # How much time should be shaved from the beginning of your data in seconds
                   Suffix = "", # A suffix to add to your onset files to better differentiate them from one another
                   Detrend = T, # Whether your parametric modulator should be detrended (i.e., subtract the value of the subsequent time point from each time point so that only changes deviate from 0)
                   Demean = T, # Whether your parametric modulator should be demeaned (i.e., calculate the average and subtract it from each data point in the time course such that data on either side of the mean are balanced)
                   ZScore = T, # Whether your parametric modulator should be standardized (i.e., converted to standard deviation units to make it more comparable across individuals and studies)
                   HighPass = F, # Whether all values below 0 should be treated as 0
                   LowPass = F, # Whether all values above 0 should be treated as 0
                   Threshold = 0, # The value in standard deviation units below which parametric modulator inflections should be ignored
                   Smoothing = F, # Whether inflections within the same overlapping bufferzones should be smoothed together (i.e., averaged across all inflection points)
                   BufferBefore = 0, # The time in seconds prior to each inflection point that should take the same value as the inflection point (to be used when the onset/duration of the event is probabilistic or unknown)
                   BufferAfter = 0, # The time in seconds following each inflection point that should take the same value as the inflection point (to be used when the onset/duration of the event is probabilistic or unknown)
                   Override = NA # Generate a cluster-based parametric modulator, but then override the values (useful to generate mean EVs) 
){
  # Loading packages
  if (require("pacman") == FALSE){
    install.packages("pacman")
  }
  
  # Loading in my packages with my pacman manager
  pacman::p_load(changepoint,
                 tidyverse)
        
  #Specifying a few misceallenous details specific to each task
  TaskFiles <- 519
  OnsetBuffer <- 17
  Folder <- TASK
      
  # Calculate how many files they have in their raw directory
  # If we find any files at this path, proceed ...
  if (length(list.files(paste0(RawDir, "sub-", PID, "/",  Folder, "/DICOM/"))) != 0){
    nFiles <- length(list.files(paste0(RawDir, "sub-", PID, "/",  Folder, "/DICOM/")))
  }
  
  # ... but if that directory doesn't work, try this other one.
  if (length(list.files(paste0(RawDir, "sub-", PID, "/scans/",  Folder, "/DICOM/"))) != 0){
    nFiles <- length(list.files(paste0(RawDir, "sub-", PID, "/scans/",  Folder, "/DICOM/")))
  }
  
  # ... and if that didn't work, try this
  if ((length(list.files(paste0(RawDir, "sub-", PID, "/",  Folder, "/DICOM/"))) == 0) & 
      (length(list.files(paste0(RawDir, "sub-", PID, "/scans/",  Folder, "/DICOM/"))) == 0) &
      (length(list.files(paste0(RawDir, "sub-", PID, "/",  Folder, "/"))) != 0)){
    nFiles <- length(list.files(paste0(RawDir, "sub-", PID, "/",  Folder, "/")))
  }
  
  # If the participant's uncertainty Task has 759 files 
  if (nFiles == 240 + TaskFiles){
    # Create an onset sequence that removes the first 90 and last 90 seconds 
    onset <- seq((90 + OnsetBuffer), ((nFiles * TR) - 90 - TR), TR)
  }
  
  # If the participant's uncertainty Task has 729 files
  if (nFiles == 210 + TaskFiles){
    # Create an onset sequence that removes the first 60 and last 60 seconds
    onset <- seq((60 + OnsetBuffer), (nFiles * TR) - 60 - TR, TR)
  } 
  
  ## GENERATING DURATION ----
  # Create a duration sequence equal to the TR across the board
  duration <- rep(TR, length(onset))
      
  ## GENERATING PARAMETRIC MODULATOR ----

  # Turn the time course in that behavioral file into parametrid modulator
  paramod <- data
  
  # If we want to detrend the data ...
  if (Detrend == TRUE){
    
    # Use the difference function to basically subtract from any given datapoint the value that preceded it
    paramod <- c(0, diff(paramod))
  }
  
  # We may later transform this array and non-zero values will be hard to distinguish from zero values. 
  # Therefore, we are identifying a zero value now for reference
  zero_point <- which(paramod == 0)[1]

  # We'll identify any array value that's non-zero
  inflections <- which(paramod != paramod[zero_point])
  
  # Scaling our array through demeaning, standardizing, or both (or neither!)
  paramod <- as.numeric(scale(paramod, scale = ZScore, center = Demean))
  
  # If we want to remove low values
  if (HighPass == TRUE){
    
    # Identify which paramod values are below 0 and make them zero
    paramod[paramod <= paramod[zero_point]] <- paramod[zero_point]
  }
  
  # If we want to remove high values
  if (LowPass == TRUE){
    
    # Identify which paramod values are above 0 and make them zero
    paramod[paramod >= paramod[zero_point]] <- paramod[zero_point]
  }
  
  # Any data points less than threshold will be converted to a value equal to zero
  if (Threshold > 0 & any(abs(paramod) > Threshold)){
    
    # First I'm removing those timepoints from the inflections variable, if they exist there
    for (CENSORED in which(abs(paramod) < Threshold)){
      if (any(inflections == CENSORED)){
        inflections <- inflections[-which(inflections == CENSORED)]
      }
    }
    
    # Now we'll actually censor those timepoints
    # paramod[which(abs(paramod) < Threshold)] <- paramod[zero_point]
    paramod[which(abs(paramod) < Threshold)] <- paramod[zero_point]
  }
  
  # If we want to use thresholding but no datapoints make it, break it off
  if (Threshold > 0 & all(abs(paramod) < Threshold)){
    print(paste0("Participant ", PID, " does not have any observations that surpass the designated threshold (", 
                 Threshold, " sd). As such, an onset file for this participant's trial could not be generated.",
                 " If you'd like an onset file, please rerun this function with a lower threshold."))
    next
  }
  
  # Our zero value may be vastly different from what it was now, so let's define it more concretely
  zero_value <- paramod[zero_point]
  
  # If we want to buffer inflections by some amount
  if (BufferBefore > 0 | BufferAfter > 0){
    
    # and if we want to smooth across contiguous time points which might otherwise compete
    if (Smoothing == TRUE){
      
      # Specifying our starting cluster
      cluster_num <- 1  
      
      # Creating an array to store the clusters each inflection belongs to
      clusters <- rep(NA, length(inflections))
      
      # Iterate through each of the identified inflection points
      for (CHANGE in inflections){
        
        # If a given inflection point stands alone or has neighbors
        if (length(which(inflections > CHANGE - BufferBefore/TR & inflections < CHANGE + BufferAfter/TR)) >= 1){
          
          # Label those contiguous or isolated points as a cluster  
          clusters[which(inflections > CHANGE - BufferBefore/TR & inflections < CHANGE + BufferAfter/TR)] <- paste0("Cluster", cluster_num)
        }
        
        # If we find an inflection point which doesn't have any contiguous points
        if (length(which(inflections > CHANGE & inflections < CHANGE + BufferAfter/TR)) == 0){
          
          # Increment the cluster number by 1
          cluster_num <- cluster_num + 1
        }
      }
      
      # Cleaning Our Space
      rm(cluster_num)
      
      # Iterating through each of the clusters
      for (CLUSTER in unique(clusters)){
        
        # And smoothing values within cluster by averaging across all values
        paramod[inflections[which(clusters == CLUSTER)]] <- mean(paramod[inflections[which(clusters == CLUSTER)]])
      }
      
      # Iterating through each of those inflections again
      for (INFLECTION in inflections){
        
        # Specifying our target region
        target <- (INFLECTION - BufferBefore/TR):(INFLECTION + BufferAfter/TR)
        
        # Copying the value of each inflection point to the buffered time points before and afterwards
        paramod[target[target > 0 & target < length(paramod)]] <- paramod[INFLECTION]
      }
      
      # Cleaning Our Space
      rm(target, clusters)
    }
    
    # and if we do not want to smooth across contiguous time points
    if (Smoothing == FALSE){
      
      # Creating a temporary array so that adding value to overlapping inflections/buffer zones doesn't compound their effects
      paramod_temp <- paramod
      
      # Iterating through each of those inflections again
      for (INFLECTION in inflections){
        
        # Iterating through each of the time points within the buffer zone for that inflection
        for (BUFFERPOINT in (INFLECTION - BufferBefore/TR):(INFLECTION + BufferAfter/TR)){
          
          # Excluding iterations where inflection and bufferpoint are synonymous
          if (BUFFERPOINT != INFLECTION & BUFFERPOINT > 0 & BUFFERPOINT < length(paramod)){
            
            # Adding the value of each inflection point to the buffered time points before and afterwards
            paramod_temp[BUFFERPOINT] <- paramod_temp[BUFFERPOINT] + (paramod[INFLECTION] - paramod[zero_point])  
          }
        }
      }
      
      # Cleaning Our Space
      paramod <- paramod_temp
      rm(paramod_temp)
    }
    
    # Before we finish up, we may have just paved over our zero point, so let's redefine it to be sure
    zero_point <- which(paramod == zero_value)[1]
    
    # Rescaling our array through demeaning, standardizing, or both (or neither!)
    paramod <- as.numeric(scale(paramod, scale = ZScore, center = Demean))
    
    # We likely just redefined our zero value again, though, so one more time with the new zero point
    zero_value <- paramod[zero_point]
  }
  
  # Specifying our starting cluster
  cluster_num <- 1  
  
  # Creating an array to store the clusters each collection of points belongs to
  clusters <- rep(NA, length(inflections))
  
  # Iterate through each of the identified inflection points
  for (DATAPOINT in 1:length(paramod)){
    
    # If we're on the first datapoint
    if (DATAPOINT == 1){
      
      # Specify that that observation is in the first cluster
      clusters[DATAPOINT] <- paste0("Cluster", cluster_num)
    }
    
    # If we're past the first observation
    if (DATAPOINT > 1){
      
      # and the current iteration is different than the one that preceded it
      if (paramod[DATAPOINT] != paramod[DATAPOINT - 1]){
        
        # Increment the cluster number by 1
        cluster_num <- cluster_num + 1
        
        # Label that observation as belonging to a new cluster
        clusters[DATAPOINT] <- paste0("Cluster", cluster_num)
      }
      
      # and the current iteration is the same as the one that preceded it
      if (paramod[DATAPOINT] == paramod[DATAPOINT - 1]){
        
        # Label that observation as belonging to the same cluster
        clusters[DATAPOINT] <- paste0("Cluster", cluster_num)
      }
    }
  }
  
  # Cleaning Our Space
  rm(cluster_num)
  
  # Creating empty arrays
  paramod_cluster <- rep(NA, length(unique(clusters)))
  onset_cluster <- rep(NA, length(unique(clusters)))
  duration_cluster <- rep(NA, length(unique(clusters)))
  
  # Iterating through each of the clusters
  for (CLUSTER in 1:length(unique(clusters))){
    
    # Identifying the duration of each cluster by counting how many observations each has and multiplying it by TR
    duration_cluster[CLUSTER] <- length(which(clusters == unique(clusters)[CLUSTER])) * TR
    
    # Identifying the onset of each cluster as the first onset associated with that cluster
    onset_cluster[CLUSTER] <- onset[which(clusters == unique(clusters)[CLUSTER])][1]
    
    # Identifying the parametric modulator of each cluster as the first value associated with that cluster
    paramod_cluster[CLUSTER] <- paramod[which(clusters == unique(clusters)[CLUSTER])][1]
    
  }

  # Concatenate onset, duration and parametric modulation into a data frame
  df_temp <- data.frame(onset_cluster, duration_cluster, paramod_cluster) 
  
  # Cleaning Our Space
  rm(paramod, paramod_cluster, onset, onset_cluster, duration, duration_cluster) 
  
  # If we want to override the values
  if (!is.na(Override) & is.numeric(Override)){
    df_temp[,grep(x = names(df_temp), 
                  pattern = "paramod")] <- Override
  }
  
  # If an onset directory doesn't already exist
  if (!dir.exists(paste0(DerivDir, "sub-", PID, "/","onset"))){
    # Create a new directory in the participant's raw files called "Onset"
    dir.create(paste0(DerivDir, "sub-", PID, "/","onset"))
  }
  
  # Set our working directory to that onset directory
  setwd(paste0(DerivDir, "sub-", PID, "/","onset"))

  # If we're working with the first half video ...
  if (TASK == "3_task-1"){
    
    # Save only the target row (which is a single observation) of our dataframe as a text file with this name
    write.table(df_temp,
                paste0("sub-", PID, "_task-run-1_Override-", Override, "_Method-", Suffix,"_timing.txt"),
                sep = "\t",
                row.names = FALSE,
                col.names = FALSE)
  }
  
  # If we're working with the second half video ...
  if (TASK == "5_task-2"){
    
    # Save the target row of our dataframe as a text file with a slightly different name
    write.table(df_temp,
                paste0("sub-", PID, "_task-run-2_Override-", Override, "_Method-", Suffix,"_timing.txt"),
                sep = "\t",
                row.names = FALSE,
                col.names = FALSE)
  }
  
  # Cleaning Space
  rm(df_temp, nFiles)
  
}


# Calling the tidyverse package
library(tidyverse)

# Setting our working directory
setwd("/data/Uncertainty/scripts/")

# Noting our participant IDs
PIDs <- read.table("00_condB.txt")[,1] %>%
  sprintf("%04d",.)

# Iterating through each Participant
for (PID in PIDs){

  # Generating Our Onset Files
  Onsets(PIDs = PID,
            data = Spline1,
            TASK = "3_task-1",
            Suffix = "Spline")
  
  Onsets(PIDs = PID,
            data = Spline1,
            TASK = "3_task-1",
            Suffix = "Spline",
            Override = 1)
  
  Onsets(PIDs = PID,
            data = CPA1,
            Detrend = F,
            TASK = "3_task-1",
            Suffix = "CPA")
  
  Onsets(PIDs = PID,
            data = CPA1,
            Detrend = F,
            TASK = "3_task-1",
            Suffix = "CPA",
            Override = 1)
}

# Setting our working directory
setwd("/data/Uncertainty/scripts/")

# Noting our participant IDs
PIDs <- read.table("00_condA.txt")[,1] %>%
  sprintf("%04d",.)

# Iterating through each Participant
for (PID in PIDs){
  
  # Generating Our Onset Files
  Onsets(PIDs = PID,
            data = Spline2,
            TASK = "5_task-2",
            Suffix = "Spline")
  
  Onsets(PIDs = PID,
            data = Spline2,
            TASK = "5_task-2",
            Suffix = "Spline",
            Override = 1)
  
  Onsets(PIDs = PID,
            data = CPA2,
            Detrend = F,
            TASK = "5_task-2",
            Suffix = "CPA")
  
  Onsets(PIDs = PID,
            data = CPA2,
            Detrend = F,
            TASK = "5_task-2",
            Suffix = "CPA",
            Override = 1)
}